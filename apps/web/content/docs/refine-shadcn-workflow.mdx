---
title: Workflow Refine + shadcn/tailwind (đơn giản & hiệu quả)
description: Khi nào dùng Refine, khi nào gọi trực tiếp Convex; cách kết hợp Refine hooks với UI shadcn/tailwind mà không phức tạp hóa dự án.
---

## Mục tiêu

- Giữ mọi thứ đơn giản, hiệu quả; chỉ dùng Refine khi nó giúp giảm lặp lại và tăng tái sử dụng.
- UI vẫn do bạn kiểm soát với shadcn/tailwind; Refine chỉ là “lớp glue” tuỳ chọn.

## Refine có làm phức tạp hóa không?

Tùy cách dùng. Refine là bộ khung resource‑centric (quản lý danh sách resource, route, hooks CRUD). Nếu bạn:

- Chỉ có vài màn hình CRUD đơn giản: gọi trực tiếp `convex/react` trong trang là đủ, nhanh gọn.
- Nhiều resource, cần tái sử dụng CRUD/hook, đồng bộ route/params, mở rộng permission/logging: thêm Refine giúp giảm lặp và ràng buộc chuẩn hơn.

Điểm lợi khi dùng Refine vừa phải:

- Resource config tập trung (`ADMIN_RESOURCES`) → menu + Refine `<resources>` tự đồng bộ.
- `DataProvider` gom CRUD/network 1 chỗ → dùng `useList/useCreate/...` tái sử dụng cho nhiều resource.
- Có thể bật từng phần: dùng Refine ở layer routing/resources, nhưng UI/logic vẫn thuần custom.

## 3 cách tiếp cận

1) Thuần Convex + shadcn (đơn giản nhất)

- Trang list/create/edit gọi trực tiếp `useQuery/useMutation` của `convex/react`.
- UI render bằng shadcn: `Table`, `Button`, `Input`...
- Phù hợp khi số resource ít, form đơn giản.

2) Refine hooks toàn phần (tái sử dụng cao)

- Mở rộng `DataProvider` cho resource mới (vd: `students`).
- Dùng `useList({ resource: "students" })`, `useCreate`, `useUpdate`, `useDelete`...
- UI vẫn shadcn; Refine chỉ cấp dữ liệu và event CRUD.

3) Hybrid (khuyến nghị để không phức tạp)

- Dùng Refine cho: resource config, đồng bộ route, có thể cho 1 số hook.
- Với tác vụ đặc thù (search nâng cao, hành vi mutation đặc biệt), vẫn gọi trực tiếp `convex/react` ngay trong trang.

## Kiến trúc gợi ý (đang dùng trong project)

- `ADMIN_RESOURCES` (config tập trung): bật/tắt resource, tạo menu & `<Refine resources>` tự động.
- `DataProvider` tối thiểu: chỉ implement nghiệp vụ đang dùng; method thừa có thể `throw new Error("not implemented")` để giữ gọn.
- Trang admin: mỗi resource có `list`, `create`, `edit` (theo mẫu `todos`). UI 100% shadcn/tailwind.

## Ví dụ nhanh (Refine hooks + shadcn)

Giả sử đã mở rộng `DataProvider` cho `students`:

```tsx
"use client";
import { useList, useCreate, useUpdate, useDelete } from "@refinedev/core";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";

type Student = { id: string; name: string; email: string; active: boolean };

export default function StudentsPage() {
  const { data, isLoading, refetch } = useList<Student>({ resource: "students" });
  const { mutate: createStudent } = useCreate();
  const { mutate: updateStudent } = useUpdate();
  const { mutate: deleteStudent } = useDelete();

  const handleCreate = async () => {
    await createStudent({ resource: "students", values: { name: "A", email: "a@x.com", active: true } });
    refetch();
  };

  const handleToggle = async (id: string, active: boolean) => {
    await updateStudent({ resource: "students", id, values: { active: !active } });
    refetch();
  };

  const handleDelete = async (id: string) => {
    await deleteStudent({ resource: "students", id });
    refetch();
  };

  if (isLoading) return <div>Loading...</div>;
  const rows = data?.data ?? [];

  return (
    <div className="space-y-4">
      <div className="flex gap-2">
        <Input placeholder="Tìm kiếm..." className="w-64" />
        <Button onClick={handleCreate}>New</Button>
      </div>
      <table className="w-full text-sm">
        <thead>
          <tr className="border-b text-left text-muted-foreground">
            <th className="px-3 py-2">Name</th>
            <th className="px-3 py-2">Email</th>
            <th className="px-3 py-2">Active</th>
            <th className="px-3 py-2 text-right">Actions</th>
          </tr>
        </thead>
        <tbody>
          {rows.map((s) => (
            <tr key={s.id} className="border-b">
              <td className="px-3 py-2">{s.name}</td>
              <td className="px-3 py-2">{s.email}</td>
              <td className="px-3 py-2">{String(s.active)}</td>
              <td className="px-3 py-2">
                <div className="flex justify-end gap-2">
                  <Button variant="outline" size="sm" onClick={() => handleToggle(s.id, s.active)}>Toggle</Button>
                  <Button variant="ghost" size="sm" onClick={() => handleDelete(s.id)}>Delete</Button>
                </div>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
}
```

`DataProvider` sẽ ánh xạ các call ở trên về Convex (ví dụ `students.update` → `convex.mutation(api.students.update, ...)`). UI vẫn thuần shadcn.

## Gợi ý giữ mọi thứ đơn giản

- Bắt đầu với cách 1 (thuần Convex) để ship nhanh.
- Khi resource tăng hoặc lặp lại CRUD nhiều: chuyển dần sang Hybrid hoặc dùng Refine hooks cho phần lặp lại.
- Giữ `DataProvider` nhỏ gọn, chỉ implement method cần dùng.
- Dùng `ADMIN_RESOURCES` để bật/tắt resource, tránh rải route/menu khắp nơi.

## Tips kỹ thuật

- Next Link: dùng API mới (`<Link href="..." prefetch={false}>`) để tránh cảnh báo và giảm sai khác SSR/CSR.
- Trang client: thêm `"use client"` đầu file; với Convex thường đặt `export const dynamic = "force-dynamic"` để tránh RSC issues.
- Không bọc `Sidebar` trong `Suspense` nếu không cần; tránh fallback khác nhau gây hydration mismatch.

